\section{Motivation}

As an increasing number of countries pass laws that facilitate mass
surveillance of their citizens~\cite{france_surveillance,
  netherlands_surveillance, kazak_surveillance, uk_bill}.  Governments
and users have been motivated more than ever since the Snowden
revelations to avoid countries known for surveillance practices,
specifically the United States~\cite{russia_secure_internet,
  routing_errors, dte}.  More recently, the Safe Harbour agreement, an
agreement that allows the free flow of data between the US and the EU,
was struck down because it would give the NSA access to EU citizens'
personal data~\cite{safe_harbour_illegal, safe_harbour_undecided}.  When
Internet traffic enters a country, it becomes subject to those countries
laws.  As a result, users have more need than ever to determine---and
control---which countries their traffic is traversing.

Certain countries such as Brazil have already taken impressive measures
to ensure that Internet traffic circumvents the United
States~\cite{brazil_history, brazil_break_from_US, brazil_conference,
  brazil_conference2, brazil_human_rights} including building a 3,500
mile long fiber-optic cable from Fortaleza to Portugal (with no use of
American vendors), pressing companies such as Google, Facebook, and
Twitter (among others) to store data locally, and switching its dominant
email system (Microsoft Outlook) to a state-developed system called
Expresso~\cite{brazil_cable, brazil_us_companies}.  Brazil is also
building Internet Exchange Points (IXPs)~\cite{brazil_IXP1}, now has the
largest national ecosystem of public Internet eXchange points in the
world~\cite{brazil_ixp_ecosystem}, and the number of internationally
connected ASes continues to grow~\cite{brazil_international_ases}.

Unfortunately, these mechanisms alone may not be sufficient to cause
traffic to circumvent a particular country. The design of the Internet
and routing protocols have no notion of national borders, and thus
Internet traffic paths are determined without any regard to
international crossings.  The BGP (Border Gateway Protocol) decides
interdomain routing paths based on shortest and most preferred paths -
not on which countries it will traverse.  This allows traffic to pass
through countries that conduct surveillance even when the traffic
originates (and possibly terminates) in a country that does not lawfully
allow surveillance.

Determining where a client's Internet traffic flows is complicated by
the complexity of websites~\cite{butkiewicz2011understanding}.  Many
websites also fetch content from other domains, which are most likely
hosted in different locations.  Therefore, the client has to make
additional web requests, which take different paths.  One initial web
request can result in content being fetched from many servers located
around the world, and to see where this traffic flows requires knowledge
of all paths from the client to requested sources (and all the requested
sources to the client).  As the number of domains, and therefore the
number of paths, increase, the more possibilities for surveillance are
introduced. 

There are ways for clients to force their traffic to avoid potential
surveillance by avoiding unfavorable jurisdictions.  One way is to use
open resolvers; a client could query a foreign resolver, such that it
appears as if the client is located in a geographically different
location.  This different location could potentially be closer to a
georeplicated server in a foreign country, and thus the path from the
client to the server has the potential to avoid certain countries.  The
same method could be used with resolvers that support EDNS; the client
could spoof the client subnet with a foreign subnet, and therefore
access a replica in a favorable country. 

Unfortunately, this approach is unsuccessful if the service uses anycast
IP addresses; this technique has increased in the past few
years~\cite{cicalese2015characterizing}.  Even though the DNS lookup is
in a different location than the client, the client will still be
accessing data from the server that is closest, which provides the
possibility of unwanted countries on the path between the client and the
server.   

Another way for a client to keep their traffic from transitting a
surveillance state is by using an overlay network.  With the use of
relays in diverse geographic locations, a client could potentially avoid
two ways that traffic could be surveilled by a foreign country.  The
first way is if the unfavorable country is on the path from the client
to the destination, and by using a relay in a different country, the
traffic never passes through the unfavorable country.  The second way is
if the closest content replica is in an unfavorable country, but by
using a relay, the closest content replica to the relay is in a
favorable country, and therefore the client accesses his content from a
replica that is not in the unfavorable country.  Additionally, sometimes
a client's traffic is domestic (ends in his own country), but traverses
international borders.  Using relays in the client's country could
potentially help keep domestic traffic local and prevent foreign
countries from surveilling this traffic. 

We start by looking at hosting diversity, more specifically, how many
countries a domain is hosted in.  More diversity should provide for the
potential to avoid more countries.  We found that about half of the
Alexa Top 100 domains in the five countries studied are hosted in more
than one country. 

Given the diversity in hosting sites, there is reason to believe that
clients can force their traffic to avoid certain countries using either
open resolvers or an overlay network.  Before measuring how avoidable a
country is, we measure the current state of routing traffic across
borders.  Our study is focused on analyzing the traffic originating in
five different countries: Brazil, Netherlands, Kenya, India, and the
United States.  Using RIPE Atlas probes and the MaxMind geolocation
service, we measure the country-level traffic paths for the Alexa Top
100 domains in each respective country.  Using the current state of
routing as a baseline for comparison, we then measure how avoidable a
given country is to a client in either Brazil, Netherlands, India,
Kenya, or the United States, using open resolvers and using the overlay
network.  Our contributions include: 

\begin{itemize}
\item First (to our knowledge) in-depth measurement study of
  nation-state routing for Brazil, Netherlands, Kenya, India, and the
  United States. 
\item Metrics for quantifying country avoidability.
\item Evaluation of the use of open resolvers and an overlay network as tools for country avoidance.
\end{itemize}
